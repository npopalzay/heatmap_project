(self.webpackChunkgeog863_final=self.webpackChunkgeog863_final||[]).push([[1930],{65737:(e,t,r)=>{"use strict";r.d(t,{B:()=>d});var i=r(18029),o=r(8073),s=r(82203),n=r(57265),a=r(17593),p=r(15392),l=r(11603),c=r(11786),y=r(19256);function d(e){const t=(0,i.pC)(e)&&e.origins?e.origins:[void 0];return(r,p)=>{const d=function(e,t,r){if((0,i.pC)(e)&&"resource"===e.type)return function(e,t,r){const s=(0,o.VZ)(t,r);return{type:String,read:(e,t,r)=>{const i=(0,y.r)(e,t,r);return s.type===String?i:"function"==typeof s.type?new s.type({url:i}):void 0},write:{writer(t,o,p,d){if(!d||!d.resources)return"string"==typeof t?void(o[p]=(0,y.t)(t,d)):void(o[p]=t.write({},d));const m=function(e){return(0,i.Wi)(e)?null:"string"==typeof e?e:e.url}(t),g=m?(0,y.t)(m,{...d,verifyItemRelativeUrls:d&&d.verifyItemRelativeUrls?{writtenUrls:d.verifyItemRelativeUrls.writtenUrls,rootPath:null}:null},1):null,v=s.type!==String&&(!(0,n.l)(this)||d&&d.origin&&this.originIdOf(r)>(0,l.M9)(d.origin));d&&d.portalItem&&(0,i.pC)(g)&&!(0,a.YP)(g)?v?function(e,t,r,i,o,s,n,p){const l=n.portalItem.resourceFromPath(i),y=f(r,i,n);(0,c.B)(y)===(0,a.Ml)(l.path)?(h(e,t,l,y,n.resources.toUpdate),o[s]=i):u(e,t,r,i,o,s,n,p)}(this,r,t,g,o,p,d,e):function(e,t,r,i){i.resources.toKeep.push({resource:i.portalItem.resourceFromPath(e)}),t[r]=e}(g,o,p,d):d&&d.portalItem&&((0,i.Wi)(g)||(0,i.pC)((0,y.i)(g))||(0,a.jc)(g)||v)?u(this,r,t,g,o,p,d,e):o[p]=g}}}}(e,t,r);switch((0,i.pC)(e)&&e.type?e.type:"other"){case"other":return{read:!0,write:!0};case"url":{const{read:e,write:t}=y.p;return{read:e,write:t}}}}(e,r,p);for(const e of t){const t=(0,s.CJ)(r,e,p);for(const e in d)t[e]=d[e]}}}function u(e,t,o,s,n,l,y,d){const u=(0,p.D)(),m=f(o,s,y),g=(0,a.v_)((0,i.U2)(d,"prefix"),u),v=`${g}.${(0,c.B)(m)}`,w=y.portalItem.resourceFromPath(v);(0,a.jc)(s)&&y.resources.pendingOperations.push(async function(e){const t=(await Promise.resolve().then(r.bind(r,65869))).default,{data:i}=await t(e,{responseType:"blob"});return i}(s).then((e=>{w.path=`${g}.${(0,c.B)(e)}`,n[l]=w.itemRelativeUrl})).catch((()=>{}))),h(e,t,w,m,y.resources.toAdd),n[l]=w.itemRelativeUrl}function h(e,t,r,i,o){o.push({resource:r,content:i,finish:r=>{!function(e,t,r){"string"==typeof e[t]?e[t]=r.url:e[t].url=r.url}(e,t,r)}})}function f(e,t,r){return"string"==typeof e?{url:t}:new Blob([JSON.stringify(e.toJSON(r))],{type:"application/json"})}},31930:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>V});var i,o=r(87397),s=(r(1867),r(18029)),n=(r(9783),r(9385),r(82203)),a=r(23757),p=r(65482),l=r(29107),c=r(19256),y=r(65737),d=r(14790),u=r(70314),h=r(71604),f=r(47596),m=r(66119),g=r(72046),v=r(4425),w=r(83320),_=r(80157),S=r(17060),b=r(37105),C=r(47205),I=r(17593),O=(r(15392),r(11786),r(49886)),T=r(50519),R=r(65869),U=r(31641),M=r(15404),N=r(17808),x=r(10114),L=(r(36458),r(12750));let P=i=class extends O.wq{constructor(e){super(e),this.geometry=null,this.type="clip"}writeGeometry(e,t,r,i){if(i.layer&&i.layer.spatialReference&&!i.layer.spatialReference.equals(this.geometry.spatialReference)){if(!(0,L.Up)(e.spatialReference,i.layer.spatialReference))return void(i&&i.messages&&i.messages.push(new M.Z("scenemodification:unsupported","Scene modifications with incompatible spatial references are not supported",{modification:this,spatialReference:i.layer.spatialReference,context:i})));const o=new x.Z;(0,L.Wt)(e,o,i.layer.spatialReference),t[r]=o.toJSON(i)}else t[r]=e.toJSON(i);delete t[r].spatialReference}clone(){return new i({geometry:(0,U.d9)(this.geometry),type:this.type})}};(0,o._)([(0,n.Cb)({type:x.Z}),(0,y.B)()],P.prototype,"geometry",void 0),(0,o._)([(0,N.c)(["web-scene","portal-item"],"geometry")],P.prototype,"writeGeometry",null),(0,o._)([(0,n.Cb)({type:["clip","mask","replace"],nonNullable:!0}),(0,y.B)()],P.prototype,"type",void 0),P=i=(0,o._)([(0,p.j)("esri.layers.support.SceneModification")],P);const j=P;var J;let Z=J=class extends((0,O.eC)(T.Z.ofType(j))){constructor(e){super(e),this.url=null}toJSON(e){return this.toArray().map((t=>t.toJSON(e))).filter((e=>!!e.geometry))}clone(){return new J({url:this.url,items:this.items.map((e=>e.clone()))})}_readModifications(e,t){for(const r of e)this.add(j.fromJSON(r,t))}static fromJSON(e,t){const r=new J;return r._readModifications(e,t),r}static async fromUrl(e,t,r){const i={url:(0,I.mN)(e),origin:"service"},o=await(0,R.default)(e,{responseType:"json",signal:(0,s.U2)(r,"signal")}),n=t.toJSON(),a=[];for(const e of o.data)a.push(j.fromJSON({...e,geometry:{...e.geometry,spatialReference:n}},i));return new J({url:e,items:a})}};(0,o._)([(0,n.Cb)({type:String})],Z.prototype,"url",void 0),Z=J=(0,o._)([(0,p.j)("esri.layers.support.SceneModifications")],Z);const B=Z;let D=class extends((0,C.V)((0,w.Y)((0,v.q)((0,_.I)((0,S.M)((0,f.R)(h.Z))))))){constructor(...e){super(...e),this.handles=new u.Z,this.geometryType="mesh",this.operationalLayerType="IntegratedMeshLayer",this.type="integrated-mesh",this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.profile="mesh-pyramids",this.modifications=null,this._modificationsSource=null,this.elevationInfo=null,this.path=null}destroy(){this.handles.destroy()}initialize(){this.handles.add((0,m.on)(this,"modifications","after-changes",(()=>this.modifications=this.modifications),null,null,!0))}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}readModifications(e,t,r){this._modificationsSource={url:(0,c.f)(e,r),context:r}}async load(e){return this.addResolvingPromise(this._doLoad(e)),this}async _doLoad(e){const t=(0,s.U2)(e,"signal");try{await this.loadFromPortal({supportedTypes:["Scene Service"]},e)}catch(e){(0,d.r9)(e)}if(await this._fetchService(t),(0,s.pC)(this._modificationsSource)){const t=await B.fromUrl(this._modificationsSource.url,this.spatialReference,e);this.setAtOrigin("modifications",t,this._modificationsSource.context.origin),this._modificationsSource=null}await this._fetchIndexAndUpdateExtent(this.nodePages,t)}beforeSave(){if(!(0,s.Wi)(this._modificationsSource))return this.load().then((()=>{}),(()=>{}))}async saveAs(e,t){return this._debouncedSaveOperations(1,{...t,getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"integrated-mesh"},e)}async save(){const e={getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"integrated-mesh"};return this._debouncedSaveOperations(0,e)}validateLayer(e){if(e.layerType&&"IntegratedMesh"!==e.layerType)throw new l.Z("integrated-mesh-layer:layer-type-not-supported","IntegratedMeshLayer does not support this layer type",{layerType:e.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new l.Z("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});if(this.version.major>1)throw new l.Z("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"})}_getTypeKeywords(){return["IntegratedMeshLayer"]}};(0,o._)([(0,n.Cb)({type:String,readOnly:!0})],D.prototype,"geometryType",void 0),(0,o._)([(0,n.Cb)({type:["show","hide"]})],D.prototype,"listMode",void 0),(0,o._)([(0,n.Cb)({type:["IntegratedMeshLayer"]})],D.prototype,"operationalLayerType",void 0),(0,o._)([(0,n.Cb)({json:{read:!1},readOnly:!0})],D.prototype,"type",void 0),(0,o._)([(0,n.Cb)({type:b.U4,readOnly:!0})],D.prototype,"nodePages",void 0),(0,o._)([(0,n.Cb)({type:[b.QI],readOnly:!0})],D.prototype,"materialDefinitions",void 0),(0,o._)([(0,n.Cb)({type:[b.Yh],readOnly:!0})],D.prototype,"textureSetDefinitions",void 0),(0,o._)([(0,n.Cb)({type:[b.H3],readOnly:!0})],D.prototype,"geometryDefinitions",void 0),(0,o._)([(0,n.Cb)({readOnly:!0})],D.prototype,"serviceUpdateTimeStamp",void 0),(0,o._)([(0,n.Cb)({type:B}),(0,y.B)({origins:["web-scene","portal-item"],type:"resource",prefix:"modifications"})],D.prototype,"modifications",void 0),(0,o._)([(0,a.r)(["web-scene","portal-item"],"modifications")],D.prototype,"readModifications",null),(0,o._)([(0,n.Cb)(g.PV)],D.prototype,"elevationInfo",void 0),(0,o._)([(0,n.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],D.prototype,"path",void 0),D=(0,o._)([(0,p.j)("esri.layers.IntegratedMeshLayer")],D);const V=D}}]);
(self.webpackChunkgeog863_final=self.webpackChunkgeog863_final||[]).push([[1598],{51598:(t,i,e)=>{"use strict";e.r(i),e.d(i,{default:()=>x});var s=e(87397),h=(e(1867),e(31641)),a=e(18029),r=(e(9783),e(9385),e(82203)),o=e(65482),n=(e(17593),e(15392),e(11786),e(78513)),c=e(70314),l=e(66119),p=e(25362),d=e(89214),g=e(93831),v=e(58115);class u{constructor(t,i,e,s,h){this.graphic=t,this.index=i,this.x=e,this.y=s,this.viewEvent=h,this.type="graphic-click"}}class _{constructor(t,i,e,s,h){this.graphic=t,this.index=i,this.x=e,this.y=s,this.viewEvent=h,this.type="graphic-double-click"}}class y{constructor(t,i,e,s,h,a,r,o,n,c){this.graphic=t,this.allGraphics=i,this.index=e,this.x=s,this.y=h,this.dx=a,this.dy=r,this.totalDx=o,this.totalDy=n,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move-start"}preventDefault(){this.defaultPrevented=!0}}class b{constructor(t,i,e,s,h,a,r,o,n,c){this.graphic=t,this.allGraphics=i,this.index=e,this.x=s,this.y=h,this.dx=a,this.dy=r,this.totalDx=o,this.totalDy=n,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move"}preventDefault(){this.defaultPrevented=!0}}class m{constructor(t,i,e,s,h,a,r,o,n,c){this.graphic=t,this.allGraphics=i,this.index=e,this.x=s,this.y=h,this.dx=a,this.dy=r,this.totalDx=o,this.totalDy=n,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move-stop"}preventDefault(){this.defaultPrevented=!0}}class f{constructor(t,i,e,s,h){this.graphic=t,this.index=i,this.x=e,this.y=s,this.viewEvent=h,this.type="graphic-pointer-over"}}class G{constructor(t,i,e,s,h){this.graphic=t,this.index=i,this.x=e,this.y=s,this.viewEvent=h,this.type="graphic-pointer-out"}}class w{constructor(t,i,e,s,h){this.graphic=t,this.index=i,this.x=e,this.y=s,this.viewEvent=h,this.type="graphic-pointer-down"}}class C{constructor(t,i,e,s,h){this.graphic=t,this.index=i,this.x=e,this.y=s,this.viewEvent=h,this.type="graphic-pointer-up"}}let k=class extends n.Z.EventedAccessor{constructor(t){super(t),this._activeGraphic=null,this._dragEvent=null,this._handles=new c.Z,this._hoverGraphic=null,this._initialDragGeometry=null,this._viewHandles=new c.Z,this._manipulators=[],this.type="graphic-mover",this.callbacks={onGraphicClick(){},onGraphicDoubleClick(){},onGraphicMoveStart(){},onGraphicMove(){},onGraphicMoveStop(){},onGraphicPointerOver(){},onGraphicPointerOut(){},onGraphicPointerDown(){},onGraphicPointerUp(){}},this.enableMoveAllGraphics=!1,this.graphics=[],this.view=null}initialize(){this._setUpManipulators(),this._handles.add([(0,l.YP)(this,["graphics","graphics.length"],(()=>{this._setUpManipulators()})),(0,l.N1)(this,"view.ready",(()=>{this._viewHandles.add([this.view.on("immediate-click",(t=>this._clickHandler(t)),p.f.TOOL),this.view.on("double-click",(t=>this._doubleClickHandler(t)),p.f.TOOL),this.view.on("pointer-down",(t=>this._pointerDownHandler(t)),p.f.TOOL),this.view.on("pointer-move",(t=>this._pointerMoveHandler(t)),p.f.TOOL),this.view.on("pointer-up",(t=>this._pointerUpHandler(t)),p.f.TOOL),this.view.on("drag",(t=>this._dragHandler(t)),p.f.TOOL),this.view.on("key-down",(t=>this._keyDownHandler(t)),p.f.TOOL)])}))])}destroy(){this.reset(),this._manipulators.forEach((t=>t.destroy())),this._manipulators=null,this._viewHandles.removeAll(),this._handles.removeAll()}get state(){const t=!!this.get("view.ready"),i=!!this.get("graphics.length"),e=this._activeGraphic;return t&&i?e?"moving":"active":t?"ready":"disabled"}reset(){this._activeGraphic=null,this._hoverGraphic=null,this._dragEvent=null}updateGeometry(t,i){const e=this.graphics[t];e&&e.set("geometry",i)}_clickHandler(t){const i=this._findTargetGraphic((0,d.vT)(t));if(i){const e=new u(i,this.graphics.indexOf(i),t.x,t.y,t);this.emit("graphic-click",e),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(e)}}_doubleClickHandler(t){const i=this._findTargetGraphic((0,d.vT)(t));if(i){const e=new _(i,this.graphics.indexOf(i),t.x,t.y,t);this.emit("graphic-double-click",e),this.callbacks.onGraphicDoubleClick&&this.callbacks.onGraphicDoubleClick(e)}}_pointerDownHandler(t){const i=this._findTargetGraphic((0,d.vT)(t));if(i){this._activeGraphic=i;const{x:e,y:s}=t,h=new w(i,this.graphics.indexOf(i),e,s,t);this.emit("graphic-pointer-down",h),this.callbacks.onGraphicPointerDown&&this.callbacks.onGraphicPointerDown(h)}else this._activeGraphic=null}_pointerUpHandler(t){if(this._activeGraphic){const{x:i,y:e}=t,s=this.graphics.indexOf(this._activeGraphic),h=new C(this._activeGraphic,s,i,e,t);this.emit("graphic-pointer-up",h),this.callbacks.onGraphicPointerUp&&this.callbacks.onGraphicPointerUp(h)}}_pointerMoveHandler(t){if(this._dragEvent)return;const i=this._findTargetGraphic((0,d.vT)(t));if(i){const{x:e,y:s}=t;if(this._hoverGraphic){if(this._hoverGraphic===i)return;const h=this.graphics.indexOf(this._hoverGraphic),a=new G(this.graphics[h],h,e,s,t);this._hoverGraphic=null,this.emit("graphic-pointer-out",a),this.callbacks.onGraphicPointerOut&&this.callbacks.onGraphicPointerOut(a)}const h=this.graphics.indexOf(i),a=new f(i,h,e,s,t);return this._hoverGraphic=i,this.emit("graphic-pointer-over",a),void(this.callbacks.onGraphicPointerOver&&this.callbacks.onGraphicPointerOver(a))}if(this._hoverGraphic){const{x:i,y:e}=t,s=this.graphics.indexOf(this._hoverGraphic),h=new G(this.graphics[s],s,i,e,t);this._hoverGraphic=null,this.emit("graphic-pointer-out",h),this.callbacks.onGraphicPointerOut&&this.callbacks.onGraphicPointerOut(h)}}_dragHandler(t){if("start"!==t.action&&!this._dragEvent||!this._activeGraphic||!this._activeGraphic.geometry)return;t.stopPropagation();const{action:i,x:e,y:s}=t,a=this.graphics.indexOf(this._activeGraphic),r=this._activeGraphic.geometry,o=this._dragEvent?e-this._dragEvent.x:0,n=this._dragEvent?s-this._dragEvent.y:0,c=e-t.origin.x,l=s-t.origin.y;if(this._activeGraphic.geometry=(0,g.e7)(r,o,n,this.view),this.enableMoveAllGraphics&&this.graphics.forEach((t=>{t!==this._activeGraphic&&(t.geometry=(0,g.e7)(t.geometry,o,n,this.view))})),this._dragEvent=t,"start"===i){this._initialDragGeometry=(0,h.d9)(r);const i=new y(this._activeGraphic,this.graphics,a,e,s,o,n,c,l,t);this.emit("graphic-move-start",i),this.callbacks.onGraphicMoveStart&&this.callbacks.onGraphicMoveStart(i),i.defaultPrevented&&this._activeGraphic.set("geometry",r)}else if("update"===i){const i=new b(this._activeGraphic,this.graphics,a,e,s,o,n,c,l,t);this.emit("graphic-move",i),this.callbacks.onGraphicMove&&this.callbacks.onGraphicMove(i),i.defaultPrevented&&this._activeGraphic.set("geometry",r)}else{const i=new m(this._activeGraphic,this.graphics,a,e,s,o,n,c,l,t);this._dragEvent=null,this._activeGraphic=null,this.emit("graphic-move-stop",i),this.callbacks.onGraphicMoveStop&&this.callbacks.onGraphicMoveStop(i),i.defaultPrevented&&this.graphics[a].set("geometry",this._initialDragGeometry),this._initialDragGeometry=null}}_keyDownHandler(t){"a"!==t.key&&"d"!==t.key&&"n"!==t.key||"moving"!==this.state||t.stopPropagation()}_findTargetGraphic(t){let i=null,e=Number.MAX_VALUE;return this._manipulators.forEach((s=>{const h=s.intersectionDistance(t);(0,a.pC)(h)&&h<e&&(e=h,i=s.graphic)})),i}_setUpManipulators(){const{graphics:t,view:i}=this;this._manipulators.forEach((t=>t.destroy())),this._manipulators=null!=t&&t.length?t.map((t=>new v.L({graphic:t,view:i}))):[]}};(0,s._)([(0,r.Cb)()],k.prototype,"_activeGraphic",void 0),(0,s._)([(0,r.Cb)({readOnly:!0})],k.prototype,"type",void 0),(0,s._)([(0,r.Cb)()],k.prototype,"callbacks",void 0),(0,s._)([(0,r.Cb)()],k.prototype,"enableMoveAllGraphics",void 0),(0,s._)([(0,r.Cb)()],k.prototype,"graphics",void 0),(0,s._)([(0,r.Cb)({readOnly:!0})],k.prototype,"state",null),(0,s._)([(0,r.Cb)()],k.prototype,"view",void 0),k=(0,s._)([(0,o.j)("esri.views.draw.support.GraphicMover")],k);const x=k},58115:(t,i,e)=>{"use strict";e.d(i,{L:()=>f});var s=e(87397),h=(e(1867),e(18029)),a=e(9783),r=(e(9385),e(82203)),o=e(65482),n=(e(17593),e(15392),e(11786),e(83374)),c=e(78513),l=e(15982),p=e(94528),d=e(61168),g=e(12750),v=e(59609),u=e(33316),_=e(46652),y=e(92382),b=e(63527);const m=a.Z.getLogger("esri.views.interactive.GraphicManipulator");let f=class extends n.Z{constructor(t){super(t),this.layer=null,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.dragging=!1,this.cursor=null,this.events=new c.Z.EventEmitter,this._circleCollisionCache=null,this._graphicSymbolChangedHandle=null,this._originalSymbol=null}set graphic(t){"mesh"!==(0,h.U2)(t.geometry,"type")?(this._circleCollisionCache=null,this._originalSymbol=t.symbol,this._set("graphic",t),this.attachSymbolChanged()):m.error("Mesh geometries are not supported")}get elevationInfo(){const t="elevationInfo"in this.graphic.layer&&this.graphic.layer.elevationInfo,i=(0,y.vu)(this.graphic),e=t?t.offset:0;return new v.Z({mode:i,offset:e})}set focusedSymbol(t){t!==this._get("focusedSymbol")&&(this._set("focusedSymbol",t),this._updateGraphicSymbol(),this._circleCollisionCache=null)}grabbableForEvent(){return!0}set grabbing(t){t!==this._get("grabbing")&&(this._set("grabbing",t),this._updateGraphicSymbol())}set hovering(t){t!==this._get("hovering")&&(this._set("hovering",t),this._updateGraphicSymbol())}set selected(t){t!==this._get("selected")&&(this._set("selected",t),this._updateGraphicSymbol(),this.events.emit("select-changed",{action:t?"select":"deselect"}))}get _focused(){return this._get("hovering")||this._get("grabbing")}destroy(){this.detachSymbolChanged(),this._resetGraphicSymbol(),this._set("view",null)}intersectionDistance(t){const i=this.graphic;if(!1===i.visible)return null;const e=i.geometry;if((0,h.Wi)(e))return null;const s=this._get("focusedSymbol"),a=(0,h.pC)(s)?s:i.symbol;return"2d"===this.view.type?this._intersectDistance2D(this.view,t,e,a):this._intersectDistance3D(this.view,t,i)}attach(){this.attachSymbolChanged(),(0,h.pC)(this.layer)&&this.layer.add(this.graphic)}detach(){this.detachSymbolChanged(),this._resetGraphicSymbol(),(0,h.pC)(this.layer)&&this.layer.remove(this.graphic)}attachSymbolChanged(){this.detachSymbolChanged(),this._graphicSymbolChangedHandle=this.graphic.watch("symbol",(t=>{(0,h.pC)(t)&&t!==this.focusedSymbol&&t!==this._originalSymbol&&(this._originalSymbol=t,this._focused&&(0,h.pC)(this.focusedSymbol)&&(this.graphic.symbol=this.focusedSymbol))}),!0)}detachSymbolChanged(){(0,h.pC)(this._graphicSymbolChangedHandle)&&(this._graphicSymbolChangedHandle.remove(),this._graphicSymbolChangedHandle=null)}_updateGraphicSymbol(){this.graphic.symbol=this._focused&&(0,h.pC)(this.focusedSymbol)?this.focusedSymbol:this._originalSymbol}_resetGraphicSymbol(){this.graphic.symbol=this._originalSymbol}_intersectDistance2D(t,i,e,s){if(s=s||(0,u.js)(e),(0,h.Wi)(s))return null;let a=this._circleCollisionCache;if("point"!==e.type||"simple-marker"!==s.type)return(0,b.D)(i,e,t)?1:null;if((0,h.Wi)(a)||!a.originalPoint.equals(e)){const i=e,h=t.spatialReference;if((0,g.Up)(i.spatialReference,h)){const t=(0,g.iV)(i,h);a={originalPoint:i.clone(),mapPoint:t,radiusPx:(0,l.F2)(s.size)},this._circleCollisionCache=a}}if((0,h.pC)(a)){const e=(0,l.md)(i,w),h=t.toScreen(a.mapPoint),r=a.radiusPx,o=h.x+(0,l.F2)(s.xoffset),n=h.y-(0,l.F2)(s.yoffset);return(0,_.j)(e,[o,n])<r*r?1:null}return null}_intersectDistance3D(t,i,e){const s=t.toMap(i,{include:[e]});return s&&(0,g.KC)(s,G,t.renderSpatialReference)?(0,d.k)(G,t.state.camera.eye):null}};(0,s._)([(0,r.Cb)({constructOnly:!0,nonNullable:!0})],f.prototype,"graphic",null),(0,s._)([(0,r.Cb)({readOnly:!0})],f.prototype,"elevationInfo",null),(0,s._)([(0,r.Cb)({constructOnly:!0,nonNullable:!0})],f.prototype,"view",void 0),(0,s._)([(0,r.Cb)({value:null})],f.prototype,"focusedSymbol",null),(0,s._)([(0,r.Cb)({constructOnly:!0})],f.prototype,"layer",void 0),(0,s._)([(0,r.Cb)()],f.prototype,"interactive",void 0),(0,s._)([(0,r.Cb)()],f.prototype,"selectable",void 0),(0,s._)([(0,r.Cb)()],f.prototype,"grabbable",void 0),(0,s._)([(0,r.Cb)({value:!1})],f.prototype,"grabbing",null),(0,s._)([(0,r.Cb)()],f.prototype,"dragging",void 0),(0,s._)([(0,r.Cb)()],f.prototype,"hovering",null),(0,s._)([(0,r.Cb)({value:!1})],f.prototype,"selected",null),(0,s._)([(0,r.Cb)()],f.prototype,"cursor",void 0),f=(0,s._)([(0,o.j)("esri.views.interactive.GraphicManipulator")],f);const G=(0,p.c)(),w=(0,l.s1)()}}]);